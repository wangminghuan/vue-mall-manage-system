webpackJsonp([4],{576:function(e,t,i){i(641);var r=i(94)(i(598),i(677),null,null);e.exports=r.exports},584:function(e,t,i){e.exports={default:i(585),__esModule:!0}},585:function(e,t,i){var r=i(19),l=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return l.stringify.apply(l,arguments)}},592:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(584),l=i.n(r);t.default={props:{disable:Boolean,width:{type:String,default:"auto"},value:{type:Object,default:function(){}}},data:function(){return{provinceArr:[],cityArr:[],regionsArr:[],provOptions:[],cityOptions:[],regOptions:[],selectProvince:"",selectCity:"",selectRegions:""}},watch:{value:function(e){this.selectProvince=e.prov,this.selectCity=e.city,this.selectRegions=e.region},selectProvince:function(e,t){e&&""!=t&&(this.selectCity="",this.selectRegions="");var i=[];this.cityArr.map(function(t){t.re_parent==e&&i.push(t)}),this.cityOptions=i,this.$emit("input",{prov:this.selectProvince,city:this.selectCity,region:this.selectRegions})},selectCity:function(e,t){e&&""!=t&&(this.selectRegions="");var i=[];this.regionsArr.map(function(t){t.re_parent==e&&i.push(t)}),this.regOptions=i,this.$emit("input",{prov:this.selectProvince,city:this.selectCity,region:this.selectRegions})},selectRegions:function(e){this.$emit("input",{prov:this.selectProvince,city:this.selectCity,region:this.selectRegions})}},methods:{getCityData:function(){var e=this,t=void 0;localStorage.getItem("__city_code__")?(t=JSON.parse(localStorage.getItem("__city_code__")),t.map(function(t){1==t.re_level?e.provinceArr.push(t):2==t.re_level?e.cityArr.push(t):e.regionsArr.push(t)})):this.$axios.post("/merchant/Region/all").then(function(i){var r=i.data;0==r.code?(t=r.data,t.map(function(t){1==t.re_level?e.provinceArr.push(t):2==t.re_level?e.cityArr.push(t):e.regionsArr.push(t)}),localStorage.setItem("__city_code__",l()(r.data))):e.$message.error("抱歉，获取地区失败，请稍候重试~")}),this.provOptions=this.provinceArr}},created:function(){this.getCityData(),this.selectProvince=this.value.prov,this.selectCity=this.value.city,this.selectRegions=this.value.region}}},598:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(584),l=i.n(r),n=i(95),o=i.n(n),a=i(662),s=i.n(a);t.default={components:{citySelect:s.a},data:function(){var e=this,t=function(t,i,r){e.ruleForm.first_quantity&&e.ruleForm.first_price&&e.ruleForm.additional_quantity&&e.ruleForm.additional_price?r():r(new Error("请将运费设置补充完善"))},i=function(t,i,r){e.ruleForm.delivery_province&&e.ruleForm.delivery_city&&e.ruleForm.delivery_area?r():r(new Error("请选择商品所在地"))};return{cityCode:{prov:"",city:"",region:""},isEdit:!!this.$route.query.id,list:{},checkList:[],centerDialogVisible:!1,nowAcive:[-1,""],cityDisabledList:[],ruleForm:{rule_type:"1",exceptional_rules:[],free_delivery_condition:[]},limitOptions:["24小时","3天","5天","不定"],myRules:{name:[{required:!0,message:"请输入模板名称",trigger:"blur"}],delivery_address:[{required:!0,message:"请输入商品详细地址",trigger:"blur"}],delivery_province:[{required:!0,validator:i}],delivery_limit:[{required:!1,message:"请选择时间",trigger:"blur"}],rule_type:[{required:!0,validator:t}]},conditionOptions:[{value:1,label:"件数"},{value:2,label:"金额"},{value:3,label:"件数+金额"}]}},computed:{provinceArr:function(){var e=void 0,t=[];return localStorage.getItem("__city_code__")?(e=JSON.parse(localStorage.getItem("__city_code__")),e.map(function(e){1==e.re_level&&t.push(e)}),t):[]}},watch:{cityCode:function(e){this.ruleForm.delivery_province=e.prov,this.ruleForm.delivery_city=e.city,this.ruleForm.delivery_area=e.region}},methods:{handleCancel:function(){this.$router.push("/infoSet_freight_list")},useProviceNameGetId:function(e){var t=[];return this.provinceArr.map(function(i,r){e.indexOf(i.re_name)>-1&&t.push(i.re_id)}),t},hadnleSelectCity:function(){this.ruleForm[this.nowAcive[1]][this.nowAcive[0]].provinces=this.useProviceNameGetId(this.checkList),this.ruleForm[this.nowAcive[1]][this.nowAcive[0]].province_names=this.checkList,this.centerDialogVisible=!1},getAllHasSelectedCity:function(e,t){var i=[];return this.ruleForm[t].map(function(t,r){e!=r&&(i=i.concat(t.province_names))}),i},handleAddCity:function(e,t){var i=this;this.checkList=[],this.cityDisabledList=this.getAllHasSelectedCity(e,t),this.ruleForm[t][e].province_names.map(function(e){i.checkList.push(e)}),this.nowAcive=[e,t],this.centerDialogVisible=!0},handleAddRules:function(e,t){var i=1==t?{additional_price:"",additional_quantity:"",first_price:"",first_quantity:"",provinces:[],province_names:[]}:{amount_volume:"",quantity_volume:"",type:1,provinces:[],province_names:[]};this.ruleForm[e].push(i)},handleDelect:function(e,t,i){var r=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.ruleForm[i].splice(t,1)})},handleSave:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var i=t.ruleForm.exceptional_rules||[],r=t.ruleForm.free_delivery_condition||[];if(i.length>0)for(var n=0;n<i.length;n++)if("string"==typeof i[n].additional_price&&(i[n].additional_price=i[n].additional_price.replace(/\s+/,"")),"string"==typeof i[n].additional_quantity&&(i[n].additional_quantity=i[n].additional_quantity.replace(/\s+/,"")),"string"==typeof i[n].first_price&&(i[n].first_price=i[n].first_price.replace(/\s+/,"")),"string"==typeof i[n].first_quantity&&(i[n].first_quantity=i[n].first_quantity.replace(/\s+/,"")),0==i[n].provinces.length||""==i[n].additional_price||""==i[n].additional_quantity||""==i[n].first_price||""==i[n].first_quantity)return void t.$message({message:"请完善指定地区运费设置",type:"warning"});if(r.length>0)for(var a=0;a<r.length;a++)if("string"==typeof r[a].quantity_volume&&(r[a].quantity_volume=r[a].quantity_volume.replace(/\s+/,"")),"string"==typeof r[a].amount_volume&&(r[a].amount_volume=r[a].amount_volume.replace(/\s+/,"")),0==r[a].provinces.length||1==r[a].type&&""==r[a].quantity_volume||2==r[a].type&&""==r[a].amount_volume||3==r[a].type&&(""==r[a].amount_volume||""==r[a].quantity_volume))return void t.$message({message:"请完善包邮设置",type:"warning"});var s=o()({},t.ruleForm);return s.free_delivery_condition=l()(t.ruleForm.free_delivery_condition),s.exceptional_rules=l()(t.ruleForm.exceptional_rules),t.$axios.post(t.isEdit?"/merchant/Freight/update":"/merchant/Freight/add",s).then(function(e){0==e.data.code&&(t.$message({message:"操作成功！",type:"success"}),setTimeout(function(){t.$router.push({path:"/infoSet_freight_list"})},1e3))}),!1}return!1})},enquiriesFunction:function(){var e=this;this.$axios.post("/merchant/Freight/get",{f_id:this.$route.query.id}).then(function(t){var i=t.data;if(0==i.code){var r={};r.f_id=i.data.f_id,r.name=i.data.name,r.rule_type=i.data.rule_type+"",r.first_price=i.data.first_price,r.first_quantity=i.data.first_quantity,r.additional_price=i.data.additional_price,r.additional_quantity=i.data.additional_quantity,r.delivery_address=i.data.delivery_address,r.delivery_limit=i.data.delivery_limit,r.exceptional_rules=i.data.exceptional_rules||[],r.free_delivery_condition=i.data.free_delivery_condition||[],r.delivery_province=i.data.delivery_province||"",r.delivery_city=i.data.delivery_city||"",r.delivery_area=i.data.delivery_area||"",e.ruleForm=r,e.cityCode={prov:parseInt(i.data.delivery_province),city:parseInt(i.data.delivery_city),region:parseInt(i.data.delivery_area)}}})}},created:function(){this.isEdit&&this.enquiriesFunction()}}},622:function(e,t,i){t=e.exports=i(568)(!1),t.push([e.i,"\n.info-freight-add .provice-cell {\n  margin-right: 10px;\n}\n.info-freight-add .el-checkbox {\n  margin-left: 30px;\n  width: 80px;\n  margin-bottom: 10px;\n}\n.info-freight-add .el-input input {\n  border-radius: 6px;\n}\n.info-freight-add .my-table thead th {\n  background: #ecf5ff;\n  color: #353535;\n  font-weight: normal;\n}\n.info-freight-add .el-table__body-wrapper {\n  overflow-x: auto;\n}\n.info-freight-add .express-info .el-input {\n  width: 90px;\n  margin: 0 10px;\n}\n.info-freight-add .tips {\n  color: #ccc;\n  font-size: 12px;\n  line-height: 32px;\n}\n.info-freight-add .opera-btn .cell {\n  text-align: center;\n}\n.info-freight-add .opera-btn span {\n  font-size: 20px;\n  font-weight: bold;\n  color: #4a9fff;\n}\n.info-freight-add .opera-btn span:nth-of-type(2) {\n  margin-left: 10px;\n}\n",""])},641:function(e,t,i){var r=i(622);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);i(569)("040c591a",r,!0)},662:function(e,t,i){var r=i(94)(i(592),i(678),null,null);e.exports=r.exports},677:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"info-freight-add"},[i("section",{staticClass:"com-content-head"},[i("el-breadcrumb",{staticClass:"crumb-nav",attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/infoSet_freight_list"}}},[e._v("信息设置")]),e._v(" "),i("el-breadcrumb-item",{attrs:{to:{path:"/infoSet_freight_list"}}},[e._v("运费模板")]),e._v(" "),i("el-breadcrumb-item",[e._v(e._s(e.isEdit?"编辑运费模板":"新建运费模板"))])],1),e._v(" "),i("h6",[e._v(e._s(e.isEdit?"编辑运费模板":"新建运费模板"))])],1),e._v(" "),i("section",{staticClass:"com-content-body"},[i("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.myRules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"模板名称",prop:"name"}},[i("el-input",{staticStyle:{width:"476px"},attrs:{placeholder:"请输入模板名称"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"商品地址",prop:"delivery_province"}},[i("citySelect",{attrs:{width:"156"},model:{value:e.cityCode,callback:function(t){e.cityCode=t},expression:"cityCode"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"",prop:"delivery_address"}},[i("el-input",{staticStyle:{width:"476px"},attrs:{placeholder:"请输入详细地址"},model:{value:e.ruleForm.delivery_address,callback:function(t){e.$set(e.ruleForm,"delivery_address",t)},expression:"ruleForm.delivery_address"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"发货时间",prop:"delivery_limit"}},[i("el-select",{staticStyle:{width:"476px"},attrs:{placeholder:"请选择"},model:{value:e.ruleForm.delivery_limit,callback:function(t){e.$set(e.ruleForm,"delivery_limit",t)},expression:"ruleForm.delivery_limit"}},e._l(e.limitOptions,function(e,t){return i("el-option",{key:t,attrs:{label:e,value:e}})})),e._v(" "),i("p",{staticClass:"tips"},[e._v("（如实设定商品的发货时间，不仅可避免发货咨询和纠纷，还能促进成交！）")])],1),e._v(" "),i("el-form-item",{attrs:{label:"计费规则",prop:"rule_type"}},[i("el-radio",{attrs:{label:"1"},model:{value:e.ruleForm.rule_type,callback:function(t){e.$set(e.ruleForm,"rule_type",t)},expression:"ruleForm.rule_type"}},[e._v("按件数计费")]),e._v(" "),i("el-radio",{attrs:{label:"2"},model:{value:e.ruleForm.rule_type,callback:function(t){e.$set(e.ruleForm,"rule_type",t)},expression:"ruleForm.rule_type"}},[e._v("按重量计费")]),e._v(" "),i("div",{staticClass:"express-info"},[i("span",[e._v("默认运费")]),i("el-input",{model:{value:e.ruleForm.first_quantity,callback:function(t){e.$set(e.ruleForm,"first_quantity",t)},expression:"ruleForm.first_quantity"}}),i("span",[e._v(e._s(1==e.ruleForm.rule_type?"件":"千克")+"内")]),i("el-input",{model:{value:e.ruleForm.first_price,callback:function(t){e.$set(e.ruleForm,"first_price",t)},expression:"ruleForm.first_price"}}),i("span",[e._v("元，每增加")]),i("el-input",{model:{value:e.ruleForm.additional_quantity,callback:function(t){e.$set(e.ruleForm,"additional_quantity",t)},expression:"ruleForm.additional_quantity"}}),i("span",[e._v(e._s(1==e.ruleForm.rule_type?"件":"千克")+"，运费增加")]),i("el-input",{model:{value:e.ruleForm.additional_price,callback:function(t){e.$set(e.ruleForm,"additional_price",t)},expression:"ruleForm.additional_price"}}),i("span",[e._v("元")]),e._v(" "),i("p",{staticClass:"tips"},[e._v("除指定地区外，其他地区使用默认运费方式")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:""}},[i("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"primary",plain:""},on:{click:function(t){e.handleAddRules("exceptional_rules",1)}}},[e._v("+为指定地区设置运费")]),e._v(" "),i("el-table",{staticClass:"my-table",staticStyle:{width:"1038px"},attrs:{data:e.ruleForm.exceptional_rules,border:"",height:"250"}},[i("el-table-column",{attrs:{prop:"sfr_provincesName",label:"运送到",width:"175"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.province_names,function(t,r){return i("span",{key:r,staticClass:"provice-cell"},[e._v(e._s(t))])}),e._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){e.handleAddCity(t.$index,"exceptional_rules")}}},[e._v("编辑")])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"sfr_init_quantity",label:1==e.ruleForm.rule_type?"首件（件）":"首重（千克）",width:"175"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{model:{value:t.row.first_quantity,callback:function(i){e.$set(t.row,"first_quantity",i)},expression:"scope.row.first_quantity"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"sfr_init_fee",label:"首费（元）",width:"175"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{model:{value:t.row.first_price,callback:function(i){e.$set(t.row,"first_price",i)},expression:"scope.row.first_price"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"sfr_add_quantity",label:1==e.ruleForm.rule_type?"续件（件）":"续重（千克）",width:"175"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{model:{value:t.row.additional_quantity,callback:function(i){e.$set(t.row,"additional_quantity",i)},expression:"scope.row.additional_quantity"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"sfr_add_price",label:"续费（元）",width:"175"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{model:{value:t.row.additional_price,callback:function(i){e.$set(t.row,"additional_price",i)},expression:"scope.row.additional_price"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticStyle:{color:"#fa5555"},attrs:{type:"text",size:"small"},on:{click:function(i){e.handleDelect(t.row,t.$index,"exceptional_rules")}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:""}},[i("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"primary",plain:""},on:{click:function(t){e.handleAddRules("free_delivery_condition",2)}}},[e._v("+为指定条件包邮")]),e._v(" "),i("el-table",{staticClass:"my-table",staticStyle:{width:"1038px"},attrs:{data:e.ruleForm.free_delivery_condition,border:"",height:"250"}},[i("el-table-column",{attrs:{prop:"sfr_provincesName",label:"运送到",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.province_names,function(t,r){return i("span",{key:r,staticClass:"provice-cell"},[e._v(e._s(t))])}),e._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){e.handleAddCity(t.$index,"free_delivery_condition")}}},[e._v("编辑")])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"sfr_init_quantity",label:"设置包邮条件",width:"694"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-select",{staticStyle:{width:"165px",margin:"0 80px"},attrs:{placeholder:"请选择条件"},model:{value:t.row.type,callback:function(i){e.$set(t.row,"type",i)},expression:"scope.row.type"}},e._l(e.conditionOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),1==t.row.type?i("span",[i("i",[e._v("满 ")]),i("el-input",{staticStyle:{width:"165px"},model:{value:t.row.quantity_volume,callback:function(i){e.$set(t.row,"quantity_volume",i)},expression:"scope.row.quantity_volume"}}),i("i",[e._v(" 件包邮")])],1):2==t.row.type?i("span",[i("i",[e._v("满 ")]),i("el-input",{staticStyle:{width:"165px"},model:{value:t.row.amount_volume,callback:function(i){e.$set(t.row,"amount_volume",i)},expression:"scope.row.amount_volume"}}),i("i",[e._v(" 元包邮")])],1):3==t.row.type?i("span",[i("i",[e._v("满 ")]),i("el-input",{staticStyle:{width:"83px"},model:{value:t.row.quantity_volume,callback:function(i){e.$set(t.row,"quantity_volume",i)},expression:"scope.row.quantity_volume"}}),i("i",[e._v(" 件，")]),i("el-input",{staticStyle:{width:"83px"},model:{value:t.row.amount_volume,callback:function(i){e.$set(t.row,"amount_volume",i)},expression:"scope.row.amount_volume"}}),i("i",[e._v(" 元包邮")])],1):e._e()]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticStyle:{color:"#fa5555"},attrs:{type:"text",size:"small"},on:{click:function(i){e.handleDelect(t.row,t.$index,"free_delivery_condition")}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:""}},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSave("ruleForm")}}},[e._v("保存")]),e._v(" "),i("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleCancel}},[e._v("取消")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"选择城市",visible:e.centerDialogVisible,width:"540px",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[i("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},e._l(e.provinceArr,function(t,r){return i("el-checkbox",{key:r,attrs:{label:t.re_name,value:t.re_id,disabled:e.cityDisabledList.indexOf(t.re_name)>-1}})})),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.hadnleSelectCity}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]}},678:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-select",{style:{width:e.width+"px"},attrs:{placeholder:"请选择省份",disabled:e.disable},model:{value:e.selectProvince,callback:function(t){e.selectProvince=t},expression:"selectProvince"}},e._l(e.provOptions,function(e){return i("el-option",{key:e.re_id,attrs:{label:e.re_name,value:e.re_id}})})),e._v(" "),i("el-select",{style:{width:e.width+"px"},attrs:{placeholder:"请选择城市",disabled:e.disable},model:{value:e.selectCity,callback:function(t){e.selectCity=t},expression:"selectCity"}},e._l(e.cityOptions,function(e){return i("el-option",{key:e.re_id,attrs:{label:e.re_name,value:e.re_id}})})),e._v(" "),i("el-select",{style:{width:e.width+"px"},attrs:{placeholder:"请选择区域",disabled:e.disable},model:{value:e.selectRegions,callback:function(t){e.selectRegions=t},expression:"selectRegions"}},e._l(e.regOptions,function(e){return i("el-option",{key:e.re_id,attrs:{label:e.re_name,value:e.re_id}})}))],1)},staticRenderFns:[]}}});